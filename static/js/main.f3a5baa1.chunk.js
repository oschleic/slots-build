(this["webpackJsonpgame-dev-assessment"]=this["webpackJsonpgame-dev-assessment"]||[]).push([[0],{57:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(41),c=(n(56),n(57),n(7)),s=n(8),o=n(11),h=n(12),d=n(3),u=n(10),l=function(e){Object(o.a)(n,e);var t=Object(h.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,e)).id=void 0,i.anchor.set(.5,0),i.id=r,i}return Object(s.a)(n,[{key:"suit",get:function(){return Math.pow(2,Math.floor(this.id/13))}},{key:"value",get:function(){var e=this.id%13+1;return 1===e&&(e=14),e}},{key:"toString",value:function(){var e=Math.floor(this.id/13);this.id;return["\u2663","\u2666","\u2665","\u2660"][e]}}],[{key:"cardHeight",value:function(){return u.c.shared.resources.card_0.texture.height}}]),n}(u.d),g=function(e){return e[e.UP=-1]="UP",e[e.DOWN=1]="DOWN",e}(g||{}),f=function(e){Object(o.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this))._cards=[],r.totalHeight=void 0,r.decks=void 0,r.rotationsRemanining=0,r.startY=void 0,r._isSpinning=!1,r.cooldown=1e3,r.direction=g.DOWN,r._cards=e.cards,r.x=e.x,r.totalHeight=e.height,r.decks=e.decks;var i=(r.totalHeight-r.cards.length*l.cardHeight())/(r.cards.length-1);r.startY=i;var a=0;return r.cards.forEach((function(e,t){var n=i*t;e.y=a+n,a+=l.cardHeight(),r.addChild(e)})),r}return Object(s.a)(n,[{key:"resize",value:function(e,t){this.totalHeight=t;var n=(this.totalHeight-this.cards.length*l.cardHeight())/(this.cards.length-1),r=0;this.cards.forEach((function(e,t){var i=n*t;e.y=r+i,r+=l.cardHeight()}))}},{key:"cards",get:function(){return this._cards}},{key:"gapHeight",get:function(){return(this.totalHeight-this.cards.length*l.cardHeight())/(this.cards.length-1)}},{key:"isSpinning",get:function(){return this._isSpinning}}]),n}(u.b),v=function(){function e(t){Object(c.a)(this,e),this.resetCount=void 0,this.randomCards=[],this.resetCount=t}return Object(s.a)(e,[{key:"randomCard",value:function(){this.randomCards.length===this.resetCount&&(this.randomCards=[]);for(var e=null;null==e;){var t=Math.floor(51*Math.random());if(-1===this.randomCards.indexOf(t)){this.randomCards.push(t);var n=u.c.shared.resources["card_"+t].texture;e=new l(n,t)}}return e}}],[{key:"randomHand",value:function(e){for(var t=[],n=[];t.length<e;){var r=Math.floor(51*Math.random());if(-1===t.indexOf(r)){t.push(r);var i=u.c.shared.resources["card_"+r].texture;n.push(new l(i,r))}}return n}}]),e}(),j=n(23);function b(e){for(var t=[],n=[],r=0;r<e.reelLength;r++){var i=v.randomHand(e.reelCount);t.push(i)}for(var a=function(r){var i=t.map((function(e){return e[r]})),a=e.width,c=a/(e.reelCount+1)*(r+1),s=new f({cards:i,height:e.height,width:a/e.reelCount,x:c,decks:[]});n.push(s)},c=0;c<e.reelCount;c++)a(c);return n}for(var p=function(e){Object(o.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).reels=[],r.isSpinning=!1,r.config=void 0,r.config=e,r.reels=b(e),r.reels.forEach((function(e){r.addChild(e)})),r}return Object(s.a)(n,[{key:"gapWidth",value:function(e,t){return e/(t.length+1)}},{key:"resize",value:function(e,t){var n=this;if(this.isSpinning)setTimeout((function(){n.resize(e,t)}),100);else{this.config.height=t,this.config.width=e;var r=e/(this.config.reelCount+1);this.reels.forEach((function(i,a){var c=r*(a+1);i.resize(e/n.config.reelCount,t),i.x=c}))}}},{key:"isSpinnable",value:function(){return!this.isSpinning}},{key:"spin",value:function(){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(!this.isSpinning){this.isSpinning=!0;for(var n=function(){var t=b(e.config);return t.forEach((function(t){t.y=-1*(e.config.height+t.gapHeight),e.addChild(t)})),t},r=[],i=[],a=0;a<this.config.reelCount;a++)i.push(0);for(var c=0;c<t;c++)r.push(n());var s=u.e.shared,o=1,h=0;s.add((function n(){if(i[i.length-1]>=t){var a=new CustomEvent("spinFinished",{detail:{outcome:e.reels}});window.dispatchEvent(a),setTimeout((function(){e.isSpinning=!1;var t=new CustomEvent("spinReady",{detail:{outcome:e.reels}});window.dispatchEvent(t)}),e.config.cooldown),s.remove(n)}for(var c=h;c<o;c++)if(i[c]>=t)h++;else{var d=r[i[c]][c],u=e.reels[c];j.a.isTweening(d)||(i[c]===t-1?j.a.to(d,{y:0,duration:(e.config.height+d.gapHeight)/4e3,ease:"none"}):j.a.to(d,{y:e.config.height+d.gapHeight,duration:2*(e.config.height+d.gapHeight)/4e3,ease:"none"})),j.a.isTweening(u)||j.a.to(u,{y:e.config.height+u.gapHeight,duration:(e.config.height+u.gapHeight)/4e3,ease:"none"}),u.y>=e.config.height&&(e.removeChild(u),e.reels[c]=d,i[c]=i[c]+1,o=Math.min(o+1,e.config.reelCount))}}))}}}]),n}(u.b),O=n(71),m=n(72),w=n(70),x=2598960,y=[1302540,1098240,123552,54912,10200,5108,3744,624,36,4],C=["High Card","1 Pair","2 Pair","3 of a Kind","Straight","Flush","Full House","4 of a Kind","Straight Flush","Royal Flush"],H=[7,8,4,5,0,1,2,9,3,6],k=[0],S=1;S<y.length;S++){var E=100/(100*(y[S]/x));k.push(E)}function M(e){for(var t=y[0],n=0;t<e;)n++,t+=y[n];return n}var F=function(){function e(t){Object(c.a)(this,e),this.returnToPlayer=void 0,this.handMultiplier=[],this.returnToPlayer=t;for(var n=0,r=0;r<x;r++){var i=M(r);n+=k[i]}for(var a=x*this.returnToPlayer/n,s=0;s<k.length;s++)this.handMultiplier.push(k[s]*a)}return Object(s.a)(e,[{key:"getGrid",value:function(e){for(var t=[],n=0;n<e[0].cards.length;n++){for(var r=[],i=0;i<e.length;i++)r.push(e[i].cards[n]);t.push(r)}return t}},{key:"payTable",get:function(){for(var e=[],t=0;t<C.length;t++)e.push({hand:C[t],multiplier:this.handMultiplier[t]});return e}},{key:"evaluateHand",value:function(e,t){var n,r,i,a=1<<e[0]|1<<e[1]|1<<e[2]|1<<e[3]|1<<e[4];for(r=-1,n=i=0;r<5;r++,i=Math.pow(2,4*e[r]))n+=i*(1+(n/i&15));return n=n%15-(a/(a&-a)==31||16444==a?3:1),n-=(t[0]==(t[1]|t[2]|t[3]|t[4])?1:0)*(31744==a?-5:1),H[n]}},{key:"decide",value:function(e,t){var n=this.getGrid(t),r=n[Math.floor(n.length/2)],i=r.map((function(e){return e.suit})),a=r.map((function(e){return e.value})),c=this.evaluateHand(a,i);return this.handMultiplier[c]*e}}]),e}(),R=n(1),T=new F(.8);function N(e){if(null==e)return{height:0,width:0};var t=getComputedStyle(e),n=e.clientHeight,r=e.clientWidth;return{height:n-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),width:r-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)}}function _(){var e=Object(r.useRef)(null),t=Object(r.useState)(!0),n=Object(d.a)(t,2),i=n[0],a=n[1],c=Object(r.useState)(!1),s=Object(d.a)(c,2),o=s[0],h=s[1];console.log("HERE");var l=Object(r.useState)(1e3),g=Object(d.a)(l,2),f=g[0],v=g[1],j=Object(r.useRef)(1e3);j.current=f;var b=Object(r.useState)(10),x=Object(d.a)(b,2),y=x[0];x[1];Object(r.useRef)(10).current=y;var C=Object(r.useState)(0),H=Object(d.a)(C,2),k=H[0],S=H[1];Object(r.useRef)(0).current=k;var E=Object(r.useState)(),M=Object(d.a)(E,2),F=M[0],_=M[1],z=Object(r.useRef)(F);z.current=F;var L=Object(r.useState)(null),P=Object(d.a)(L,2),B=P[0],W=P[1],D=Object(r.useRef)(B);D.current=B;var A=Object(r.useState)(!1),G=Object(d.a)(A,2),I=G[0],J=G[1];Object(r.useEffect)((function(){if(console.log("Mounted"),null!=e.current){var t=N(e.current),n=t.height,r=t.width,i=new u.a({height:n,width:r,backgroundColor:43604,autoStart:!0});_(i);for(var c=["clover","diamond","heart","spade"],s=0;s<c.length;s++)for(var o=1;o<=13;o++)u.c.shared.add("card_".concat(13*s+o-1),"/slots-build/assets/".concat(c[s],"/card_").concat(o,"_").concat(c[s],".png"));u.c.shared.onComplete.add((function(){return a(!1)})),u.c.shared.load((function(){}))}var d=function(){var t,n=N(e.current),r=n.height,i=n.width;null==z.current||r==z.current.screen.height&&i==z.current.screen.width||(z.current.renderer.resize(i,r),null===(t=D.current)||void 0===t||t.resize(i,r))},l=function(e){var t=T.decide(y,e.detail.outcome);S(t),v(j.current+t)},g=function(e){h(!1)};return window.addEventListener("spinFinished",l),window.addEventListener("spinReady",g),window.addEventListener("resize",d),function(){window.removeEventListener("spinFinished",l),window.removeEventListener("spinReady",g),window.removeEventListener("resize",d),null===F||void 0===F||F.destroy(!0)}}),[]),Object(r.useEffect)((function(){if(null!=e.current&&null!=F){e.current.appendChild(F.view);var t=new p({reelLength:5,reelCount:5,height:F.screen.height,width:F.screen.width,cooldown:1e3});W(t),F.stage.addChild(t),u.e.shared.start()}}),[i]);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"game-container",children:Object(R.jsxs)(O.a,{children:[Object(R.jsxs)(O.a.Header,{className:"game-header",children:[Object(R.jsx)("div",{className:"game-header-item"}),Object(R.jsx)("div",{className:"game-header-item",style:{textAlign:"center"},children:"Slot Machine"}),Object(R.jsx)("div",{className:"game-header-item",style:{textAlign:"right"},children:Object(R.jsx)(m.a,{onClick:function(){return J(!0)},style:{background:"#C0C0C0"},size:"sm",children:"?"})})]}),Object(R.jsxs)("div",{className:"info-header",children:[Object(R.jsxs)("span",{children:["Balance: ",f.toFixed(2)]}),Object(R.jsxs)("span",{children:["Bet: ",y]}),Object(R.jsxs)("span",{children:["Win: ",k.toFixed(2)]})]}),Object(R.jsx)("div",{ref:e,className:"game-view"}),Object(R.jsx)(O.a.Footer,{children:Object(R.jsx)(m.a,{disabled:null===B||o||!B.isSpinnable,onClick:function(){null!==B&&void 0!==B&&B.isSpinnable()&&(h(!0),v(f-y),null===B||void 0===B||B.spin())},children:"SPIN"})})]})}),Object(R.jsxs)(w.a,{show:I,onHide:function(){return J(!1)},children:[Object(R.jsx)(w.a.Header,{closeButton:!0,children:Object(R.jsx)(w.a.Title,{children:"Pay Table"})}),Object(R.jsx)(w.a.Body,{children:Object(R.jsxs)("table",{children:[Object(R.jsx)("thead",{children:Object(R.jsxs)("tr",{children:[Object(R.jsx)("th",{children:"Hand"}),Object(R.jsx)("th",{children:"Multiplier"})]})}),Object(R.jsx)("tbody",{children:T.payTable.map((function(e,t){return Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{children:e.hand}),Object(R.jsx)("td",{children:e.multiplier})]},t)}))})]})})]})]})}var z=function(e){Object(o.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(_,{})})}}]),n}(i.a.Component),L=n(49);a.createRoot(document.getElementById("root")).render(Object(R.jsx)(L.a,{children:Object(R.jsx)(z,{})}))}},[[67,1,2]]]);
//# sourceMappingURL=main.f3a5baa1.chunk.js.map